<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>空闲时间选择器测试</title>

    <script src="../static/js/jquery-1.11.0.js"></script>

    <link href="../static/css/google_material_icons.css" rel="stylesheet">
    <link href="../static/css/materialize.css" rel="stylesheet">

    <script type="text/javascript" src="../static/js/materialize.js"></script>

    <link href="../static/css/freetimechecker.css" rel="stylesheet">
</head>
<body>

    <div class="container freetime-picker-main">

        <div class="row">

            <div class="col s8">
                <span class="flow-text">在这里点选空闲时间</span>
            </div>

        </div>

        <div class="row">
             <div class="col s1 freetime-head">&nbsp;</div>
             <div class="col s1 freetime-head">周一</div>
            <div class="col s1 freetime-head">周二</div>
            <div class="col s1 freetime-head">周三</div>
            <div class="col s1 freetime-head">周四</div>
            <div class="col s1 freetime-head">周五</div>
            <div class="col s1 freetime-head">周六</div>
            <div class="col s1 freetime-head">周日</div>
        </div>
        
        <div class="row">
            <div class="col s1 freetime">1-2</div>
            <div name="free-time-picker" id="MON-1-2" class="col s1 waves-effect freetime btn-large">&nbsp;</div>
            <div name="free-time-picker" id="TUE-1-2" class="col s1 waves-effect freetime btn-large">&nbsp;</div>
            <div name="free-time-picker" id="WED-1-2" class="col s1 waves-effect freetime btn-large">&nbsp;</div>
            <div name="free-time-picker" id="THU-1-2" class="col s1 waves-effect freetime btn-large">&nbsp;</div>
            <div name="free-time-picker" id="FRI-1-2" class="col s1 waves-effect freetime btn-large">&nbsp;</div>
            <div name="free-time-picker" id="SAT-1-2" class="col s1 waves-effect freetime btn-large">&nbsp;</div>
            <div name="free-time-picker" id="SUN-1-2" class="col s1 waves-effect freetime btn-large">&nbsp;</div>
        </div>

        <div class="row">
            <div class="col s1 freetime">3-4</div>
            <div name="free-time-picker" id="MON-3-4" class="col s1 waves-effect freetime btn-large">&nbsp;</div>
            <div name="free-time-picker" id="TUE-3-4" class="col s1 waves-effect freetime btn-large">&nbsp;</div>
            <div name="free-time-picker" id="WED-3-4" class="col s1 waves-effect freetime btn-large">&nbsp;</div>
            <div name="free-time-picker" id="THU-3-4" class="col s1 waves-effect freetime btn-large">&nbsp;</div>
            <div name="free-time-picker" id="FRI-3-4" class="col s1 waves-effect freetime btn-large">&nbsp;</div>
            <div name="free-time-picker" id="SAT-3-4" class="col s1 waves-effect freetime btn-large">&nbsp;</div>
            <div name="free-time-picker" id="SUN-3-4" class="col s1 waves-effect freetime btn-large">&nbsp;</div>
        </div>

        <div class="row">
            <div class="col s1 freetime">5-6</div>
            <div name="free-time-picker" id="MON-5-6" class="col s1 waves-effect freetime btn-large">&nbsp;</div>
            <div name="free-time-picker" id="TUE-5-6" class="col s1 waves-effect freetime btn-large">&nbsp;</div>
            <div name="free-time-picker" id="WED-5-6" class="col s1 waves-effect freetime btn-large">&nbsp;</div>
            <div name="free-time-picker" id="THU-5-6" class="col s1 waves-effect freetime btn-large">&nbsp;</div>
            <div name="free-time-picker" id="FRI-5-6" class="col s1 waves-effect freetime btn-large">&nbsp;</div>
            <div name="free-time-picker" id="SAT-5-6" class="col s1 waves-effect freetime btn-large">&nbsp;</div>
            <div name="free-time-picker" id="SUN-5-6" class="col s1 waves-effect freetime btn-large">&nbsp;</div>
        </div>

        <div class="row">
            <div class="col s1 freetime">7-8</div>
            <div name="free-time-picker" id="MON-7-8" class="col s1 waves-effect freetime btn-large">&nbsp;</div>
            <div name="free-time-picker" id="TUE-7-8" class="col s1 waves-effect freetime btn-large">&nbsp;</div>
            <div name="free-time-picker" id="WED-7-8" class="col s1 waves-effect freetime btn-large">&nbsp;</div>
            <div name="free-time-picker" id="THU-7-8" class="col s1 waves-effect freetime btn-large">&nbsp;</div>
            <div name="free-time-picker" id="FRI-7-8" class="col s1 waves-effect freetime btn-large">&nbsp;</div>
            <div name="free-time-picker" id="SAT-7-8" class="col s1 waves-effect freetime btn-large">&nbsp;</div>
            <div name="free-time-picker" id="SUN-7-8" class="col s1 waves-effect freetime btn-large">&nbsp;</div>
        </div>

        <div class="row">
            <div class="col s1 freetime">9-10</div>
            <div name="free-time-picker" id="MON-9-10" class="col s1 waves-effect freetime btn-large">&nbsp;</div>
            <div name="free-time-picker" id="TUE-9-10" class="col s1 waves-effect freetime btn-large">&nbsp;</div>
            <div name="free-time-picker" id="WED-9-10" class="col s1 waves-effect freetime btn-large">&nbsp;</div>
            <div name="free-time-picker" id="THU-9-10" class="col s1 waves-effect freetime btn-large">&nbsp;</div>
            <div name="free-time-picker" id="FRI-9-10" class="col s1 waves-effect freetime btn-large">&nbsp;</div>
            <div name="free-time-picker" id="SAT-9-10" class="col s1 waves-effect freetime btn-large">&nbsp;</div>
            <div name="free-time-picker" id="SUN-9-10" class="col s1 waves-effect freetime btn-large">&nbsp;</div>
        </div>

        <div class="row">
            <div class="col s1 freetime">11-12</div>
            <div name="free-time-picker" id="MON-11-12" class="col s1 waves-effect freetime btn-large">&nbsp;</div>
            <div name="free-time-picker" id="TUE-11-12" class="col s1 waves-effect freetime btn-large">&nbsp;</div>
            <div name="free-time-picker" id="WED-11-12" class="col s1 waves-effect freetime btn-large">&nbsp;</div>
            <div name="free-time-picker" id="THU-11-12" class="col s1 waves-effect freetime btn-large">&nbsp;</div>
            <div name="free-time-picker" id="FRI-11-12" class="col s1 waves-effect freetime btn-large">&nbsp;</div>
            <div name="free-time-picker" id="SAT-11-12" class="col s1 waves-effect freetime btn-large">&nbsp;</div>
            <div name="free-time-picker" id="SUN-11-12" class="col s1 waves-effect freetime btn-large">&nbsp;</div>
        </div>


    </div>

    <div class="container submit-bar">
        <div class="row">
            <div class="col s6">
                <a class="btn orange" onclick="clearFreeTimePick()">清除重选</a>
            </div>
            <div class="col s6">
                <a class="btn" onclick="submitFreeTimePick()">提交</a>
            </div>
        </div>
    </div>

    <script>

        function handleFreeTimePick(cellID){
            var cell = $("#"+cellID);
            if(cell.attr("freetime_checked") == "yes"){
                    cell.attr("freetime_checked", "no");
                    cell.css("background-color", "#FFFFFF");
            }
            else{
                    cell.attr("freetime_checked", "yes");
                    cell.css("background-color", "#4db6ac")
            }
        }

        function submitFreeTimePick(){
            var tds = document.getElementsByName("free-time-picker");
            var result=[];

            for(var i=0; i<tds.length; i++){
                var cell=$("#"+tds[i].id);
                if(cell.attr("freetime_checked") == "yes"){
                    result.push(tds[i].id)
                }
            }

            //For debug
            alert("已统计的空闲时间如下：\n" + result.toString());

            //TODO: 接下来可以将统计信息发往后台了。就用AJAX。

        }

        function clearFreeTimePick(){
            var tds = document.getElementsByName("free-time-picker");
            for(var i=0; i<tds.length; i++){
                var cell=$("#"+tds[i].id);
                cell.css("background-color", "#FFFFFF")
            }
        }

        var tds = document.getElementsByName("free-time-picker");
        for(var i=0; i<tds.length; i++)
        {
            $("#"+tds[i].id).attr("onclick","handleFreeTimePick('"+tds[i].id+"')")
        }


    </script>

</body>
</html>